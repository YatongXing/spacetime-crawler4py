<!-- URL: https://grape.ics.uci.edu/wiki/public/wiki/cs222-2018-fall-project2 -->

<!DOCTYPE html>
<html lang="en-US">   <head>
    <!-- # block head (placeholder in theme.html) -->
        <!-- # block head (content inherited from layout.html) -->
    <title>
      cs222-2018-fall-project2     – Public

    </title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--[if IE]><script>
        if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
        </script><![endif]-->

    <link rel="start"  href="/wiki/public/wiki" />
    <link rel="search"  href="/wiki/public/search" />
    <link rel="help"  href="/wiki/public/wiki/TracGuide" />
    <link rel="stylesheet"  href="/wiki/public/chrome/common/css/trac.css" type="text/css" />
    <link rel="stylesheet"  href="/wiki/public/chrome/common/css/wiki.css" type="text/css" />
    <link rel="icon"  href="/wiki/public/chrome/site/favicon.ico" type="image/x-icon" />
    <link rel="alternate"  href="/wiki/public/wiki/cs222-2018-fall-project2?format=txt" title="Plain Text" type="text/x-trac-wiki" />
    <noscript>
      <style>
        .trac-noscript { display: none !important }
      </style>     </noscript>
    <script src="/wiki/public/chrome/common/js/jquery.js"></script>
    <script src="/wiki/public/chrome/common/js/babel.js"></script>
    <script src="/wiki/public/chrome/common/js/trac.js"></script>
    <script src="/wiki/public/chrome/common/js/search.js"></script>
    <script src="/wiki/public/chrome/common/js/folding.js"></script>
    <script src="/wiki/public/chrome/common/js/wiki.js"></script>
    <script>
      jQuery(function($) {
        $(".trac-autofocus").focus();
        $(".trac-target-new").attr("target", "_blank");
        if ($.ui) { /* is jquery-ui added? */
          $(".trac-datepicker:not([readonly])")
            .prop("autocomplete", "off").datepicker();
          // Input current date when today is pressed.
          var _goToToday = $.datepicker._gotoToday;
          $.datepicker._gotoToday = function(id) {
            _goToToday.call(this, id);
            this._selectDate(id)
          };
          $(".trac-datetimepicker:not([readonly])")
            .prop("autocomplete", "off").datetimepicker();
          $("#main").addClass("trac-nodatetimehint");
        }
        $(".trac-disable").disableSubmit(".trac-disable-determinant");
        setTimeout(function() { $(".trac-scroll").scrollToTop() }, 1);
        $(".trac-disable-on-submit").disableOnSubmit();
      });
    </script>
    <!--   # include 'site_head.html' (layout.html) -->
    <!--   end of site_head.html -->
    <!-- # endblock head (content inherited from layout.html) -->


    <script>
      jQuery(function($) {
        wikiColumn($("#wikipage"));
      });
    </script>
    <!-- # endblock head (placeholder in theme.html) -->
  </head> 
  <body>
    <!-- # block body (content inherited from theme.html) -->
    <!--   # include 'site_header.html' (theme.html) -->
    <!--   end of site_header.html -->

    <div id="banner">
      <div id="header">
        <a id="logo"
           href="http://www.ics.uci.edu/">
          <img  alt="ICS Logo" height="67" src="/wiki/public/chrome/site/ics.jpg" width="128" /></a>


      </div>
      <form id="search" action="/wiki/public/search" method="get">
      </form>
          <div id="metanav" class="nav">
      <ul><li  class="first"><a href="/wiki/public/login">Login</a></li><li ><a href="/wiki/public/prefs">Preferences</a></li><li ><a href="/wiki/public/about">About Trac</a></li><li  class="last"><a href="/wiki/public/register">Register</a></li></ul>
    </div>

    </div>
        <div id="mainnav" class="nav">
    </div>


    <div id="main"
         >

<div id="pagepath" class="noprint">
<a class="pathentry first" title="View WikiStart"
   href="/wiki/public/wiki">wiki:</a><a href="/wiki/public/wiki/cs222-2018-fall-project2"
     title="View cs222-2018-fall-project2"
     class="pathentry">cs222-2018-fall-project2</a></div>      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
        <ul>
          <li  class="first last"><a href="/wiki/public/wiki/cs222-2018-fall-project2?action=history">History</a></li>
        </ul>
        <hr />
      </div>

      

      

      <!-- # block content (placeholder in theme.html) -->
    <div id="content" class="wiki narrow">

      <div class="wikipage searchable">
        <div id="wikipage" class="trac-content borderless"><div class="wikipage" style="background-color:rgb(237,222,222)"><p>
</p><div class="wiki-toc">
<ol>
  <li>
    <ol>
      <li>
        <a href="#Introduction">Introduction</a>
      </li>
      <li>
        <a href="#CodeBase">CodeBase</a>
      </li>
      <li>
        <a href="#MemoryRequirements">Memory Requirements</a>
      </li>
      <li>
        <a href="#SubmissionInstructions">Submission Instructions</a>
      </li>
      <li>
        <a href="#DebuggingtoolRequirements">Debugging tool Requirements</a>
      </li>
      <li>
        <a href="#Testing">Testing</a>
      </li>
      <li>
        <a href="#GradingRubrics">Grading Rubrics</a>
      </li>
      <li>
        <a href="#QA">Q &amp; A</a>
      </li>
    </ol>
  </li>
</ol>
</div><p>
</p>
<div class="wikipage" style="background-color:rgb(237,237,222)"><h1 class="section" id="Project2forCS222:ImplementingaRelationManager">Project 2 for CS222: Implementing a Relation Manager</h1>
</div><blockquote>
<p>
<strong> Deadline: Oct 29, 2018, Monday, 11:45 pm, on Github.</strong> 
</p>
</blockquote>
<h2 class="section" id="Introduction">Introduction</h2>
<p>
In Project 2, you will continue implementing the record-based file manager (RBFM) that you started in project 1. In addition, you will implement a relation manager (RM) on top of the basic record-based file system. Please check the details in the <a class="wiki" href="/wiki/public/wiki/cs222-2018-fall-project2-description">Project 2 Description</a>.
</p>
<h2 class="section" id="CodeBase">CodeBase</h2>
<p>
As in Project 1, we have provided you with a framework to implement Project 2. You can pull again from the github repo <a class="ext-link" href="https://github.com/UCI-Chenli-teaching/cs222-fall18"><span class="icon">​</span>https://github.com/UCI-Chenli-teaching/cs222-fall18</a>. Follow these instructions inside the codebase folder to start your coding:
</p>
<ul><li>Modify the "CODEROOT" variable in makefile.inc to point to the root of your codebase if necessary.
</li><li>Put your own implementation of the record-based file manager (RBFM) component to the folder "rbf".
</li><li>Implement the remaining methods of the RBFM, and then implement the relation manager (RM).
</li><li>Be sure to implement the API of the RBFM and the RM exactly as defined in rbfm.h and rm.h respectively. If you think changes are necessary, please contact us first.
</li></ul><h2 class="section" id="MemoryRequirements">Memory Requirements</h2>
<p>
As you did in Project 1, you should be careful about how you use memory as you implement your project's operations. It is NOT ACCEPTABLE to cache the entire database or even a large portion of the database in memory, since that is not practical for large amounts of data. Also, for each operation, you should make sure that the "effect" of the operation (if any) has indeed been persisted in the appropriate Linux file. For example, for the "insertTuple" operation, after the function successfully returns, the inserted record should have been stored in the file in the Linux filesystem. The tests will help you to not make mistakes here -- that is why each test case is run separately from the others.
</p>
<h2 class="section" id="SubmissionInstructions">Submission Instructions</h2>
<p>
The following are requirements on your submission. <strong>Points will likely to be deducted if they are not followed.</strong>
</p>
<ul><li>Write a report to briefly describe the design and implementation of your relation module by referencing the report template file. Please provide a text file rather than a PDF, Word Document, or other non-text format.
</li><li>You need to submit the source code under the "rbf" and "rm" folders. Make sure to do a "make clean" first, and do NOT include any useless files (such as binary files and data files). You should make sure your makefile runs properly. We will use the provided test cases to test your module. In addition we will use a set of private test cases to further evaluate your code, so be aware that you are responsible for turning in well-tested code.
</li><li>Please organize your project in the following directory hierarchy:<br />
</li></ul><blockquote>
<blockquote>
<p>
master / {rm, rbf, makefile.inc, readme.txt, project2-report.txt}
</p>
</blockquote>
<p>
where the rm and rbf folders include your source code and the makefile.<br />
</p>
</blockquote>
<ul><li>To test whether your code is structured properly, you can make a zip file from the master (by compressing your local directory or downloading from Github). Put  <a class="attachment" href="/wiki/public/attachment/wiki/cs222-2018-fall-project2/test.sh" title="Attachment 'test.sh' in cs222-2018-fall-project2">this script</a><a class="trac-rawlink" href="/wiki/public/raw-attachment/wiki/cs222-2018-fall-project2/test.sh" title="Download">​</a>​ and the zip file under the same directory. Run it to verify that your project can be properly unzipped and tested (using your own makefile.inc and rbftest.cc when you are testing the script). If the script doesn't work correctly, it's likely that your folder organization doesn't meet the above requirements. Our grading will be done by automatically done by running the script. The usage of the script is:
<pre class="wiki">    ./test.sh ''project2-groupID''
</pre></li></ul><h2 class="section" id="DebuggingtoolRequirements">Debugging tool Requirements</h2>
<p>
We highly encourage students to use GDB and Valgrind to debug program. In order to facilitate learning and using GDB and Valgrind, you are required to submit 
</p>
<ul><li>One screenshot of debugging your program under Eclipse or other IDE, using GDB or other debuggers. The screenshot must capture the Debug view and have breakpoints in them.
</li><li>Two Valgrind reports running on two different test cases of your choice. There may be memory leaks introduced by our provided code, but you should try to get rid of memory leaks as much as you can in your implementation. Grading is based on whether you submit the reports or not and having memory leaks in the reports won't lose the points. The purpose of this requirement is to let you try Valgrind to debug your program.
</li></ul><p>
You can push the screenshots into your master branch along with the project report.txt.
</p>
<h2 class="section" id="Testing">Testing</h2>
<p>
Please use the test cases <strong>rmtest_create_tables.cc</strong> and <strong>rmtest_XX.cc</strong> (where XX is the test case number) included in the codebase to test your code. Note that those files will be used to grade your project partially since we also have our own private test cases. This is by no means an exhaustive test suite. Please feel free to add more cases to this, and be sure to test your code thoroughly.
</p>
<p>
<strong>Important Note:</strong> We have provided each test case as a separate program. You must run the test case <strong>rmtest_create_tables.cc</strong> first to create the database tables needed by other test cases. Also, you must execute the tests cases in the order provided in <a class="attachment" href="/wiki/public/attachment/wiki/cs222-2018-fall-project2/test.sh" title="Attachment 'test.sh' in cs222-2018-fall-project2">this script</a><a class="trac-rawlink" href="/wiki/public/raw-attachment/wiki/cs222-2018-fall-project2/test.sh" title="Download">​</a>. This is because, although the test cases are separate programs, some of the test cases depend on other test cases (e.g., <strong>rmtest_08.cc</strong> inserts tuples and <strong>rmtest_09.cc</strong> reads them). 
</p>
<p>
Clearly the more test cases you try, the less likely it is that you will miss bugs in your implementation. Make sure to follow the requirements described in the rbf/rbfm.h and rm/rm.h files (e.g., the format of the data for a record to be read/written from/to the relation manager) since we will write our own private test cases to evaluate your implementation (on both correctness and performance).
</p>
<p>
Since there is an extra credit of 10 points available in this part of the project, we also provided the files <strong>rmtest_extra_XX.cc​</strong> (can be found in the codebase) which can be used to test your code if you decide to implement the extra credit work.
</p>
<h2 class="section" id="GradingRubrics">Grading Rubrics</h2>
<p>
Grading rubrics are on <a class="wiki" href="/wiki/public/wiki/cs222-2018-fall-project2-grading">this page</a>!
</p>
<h2 class="section" id="QA">Q &amp; A</h2>
<ul><li><strong>Q1</strong>: Can I use a WIN32 API like <a class="ext-link" href="http://msdn.microsoft.com/en-us/library/aa364232%28v=VS.85%29.aspx"><span class="icon">​</span>http://msdn.microsoft.com/en-us/library/aa364232%28v=VS.85%29.aspx</a>? <br /> 
<strong>A1</strong>: The Windows API will not be allowed. We have provided the MinGW environment, which implements most of the standard lib c/c++ functions on Windows, and those functions are powerful enough for your implementation. Your code should be able to be compiled by a standard g++ compiler. (Implementations based on other OS-specific APIs won't be supported when we do the grading.) Before submitting your project, please make sure that your code can be built by using make with gcc/g++ as the compiler.
</li></ul><ul><li><strong>Q2</strong>: Are we allowed to change the rids of existing records (tuples) when compacting a page after updating or deleting a record (tuple) on it? <br />
<strong>A2</strong>: You are NOT allowed to change the rids, as they will be used later by other external index structures and it's too expensive to modify those structures for each such change. The rids must not change under any circumstances as long as the corresponding records exist. 
</li></ul><ul><li><strong>Q3</strong>: How should the RM layer lifecycle for file use work - in particular, when would we be expected to fetch and update (persist) the on-disk catalogs?  Should each RM layer call (such as insertRecord(), readRecord, or scan()) make catalog calls? Please give us a hint as to where the catalog calls should go. <br />
<strong>A3</strong>: Use the RM lifecycle as the open lifecycle for catalog files, i.e. catalog files can be opened in the RM constructor and closed in the RM destructor.<br />
</li></ul><ul><li><strong>Q4</strong>: Suppose that a file is made of 3 pages, pages 0, 1 and 2. After a few record deletions, page 1 becomes entirely free. Should page 1 be freed up at this point? I notice that there is no deletePage() member function in FileHandle. Does this mean that pages, once appended to a file, will never be released back until the file is deleted?<br />
<strong>A4</strong>: Yes. Let the future insertions or updates fill that page again.
</li></ul><ul><li><strong>Q5</strong>: Shall we consider the case that a single-page (4096 bytes) can't hold one record, i.e. can a single record need more than 4096 bytes?<br />
<strong>A5</strong>: No. You can assume that an empty page can hold at least one record even if the record size is "big". If a given record (tuple) is too big for an empty page, return an error when its insertions attempted.
</li></ul><ul><li><strong>Q6</strong>: Considering that Project 1 forms the basis for projects 2, 3 and 4, does any part of project 1 need to be thread safe?<br />
<strong>A6</strong>: In this project, the assumption is that there is only one user who uses the DBMS system. Therefore, single-threading is a fair assumption here. However, note that there might be multiple accesses to a given file - but only in read-only cases, which is consistent with the project description in the wiki: "Warning: Opening a file more than once <em>for data modification</em> is not prevented by the PF component, but doing so is likely to corrupt the file structure and may crash the PF component. Opening a file more than once <em>for reading</em> is no problem."
</li></ul><ul><li><strong>Q7</strong>: In response to a different question, I saw that insertRecord() should result in the changes getting written to the disk. From this, it appears that a functional buffer manager is not required as part of project1. Is this correct? If yes, is it going to be a part of the later projects? Or is it the case that we wont be needing the buffer manager at all for the entire project?<br />
<strong>A7</strong>: We have periodically pondered adding a buffer management requirement (w/replacement, etc.) into Part 1 - and almost did that for the grad-level project - but we've opted to let the Unix filesystem do that instead. (And to just rely on that, and to therefore let the layers of this project simply issue reads and writes and appends, letting Unix optimize the reads by finding recent pages in the OS level buffer pool.)
</li></ul></div></div>
        <div class="trac-modifiedby">
          <span>
            <a href="/wiki/public/wiki/cs222-2018-fall-project2?action=diff&amp;version=3" title="Version 3 by Chen Luo">Last modified</a>
 <a class="timeline" href="/wiki/public/timeline?from=2018-10-13T18%3A50%3A00-07%3A00&amp;precision=second" title="See timeline at Oct 13, 2018, 6:50:00 PM">7 years ago</a>          </span>
          <span class="trac-print">
            Last modified on Oct 13, 2018, 6:50:00 PM
          </span>
        </div>
      </div>





<div id="attachments">
  <h3  class="foldable">
    Attachments
    <span class="trac-count">(1)</span></h3>
  <div>
    <ul>
      <li>
        <a href="/wiki/public/attachment/wiki/cs222-2018-fall-project2/test.sh" title="View attachment">test.sh</a><a href="/wiki/public/raw-attachment/wiki/cs222-2018-fall-project2/test.sh"
          class="trac-rawlink" title="Download">&#8203;</a>
 (<span title="759 bytes">759 bytes</span>
) - added by <span class="trac-author">Chen Luo</span> <a class="timeline" href="/wiki/public/timeline?from=2018-10-08T15%3A17%3A02-07%3A00&amp;precision=second" title="See timeline at Oct 8, 2018, 3:17:02 PM">7 years ago</a>.
      </li>
    </ul>
    <p>
  Download all attachments as:
  <a rel="nofollow" href="/wiki/public/zip-attachment/wiki/cs222-2018-fall-project2/">.zip</a>
</p>

  </div>
</div>
<div class="trac-help">
  <strong>Note:</strong>
 See   <a href="/wiki/public/wiki/TracWiki">TracWiki</a>
 for help on using the wiki.
</div>
    </div>
        <!-- # block content (content inherited from layout.html) -->
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first last">
          <a rel="nofollow" href="/wiki/public/wiki/cs222-2018-fall-project2?format=txt"
              class="">
            Plain Text</a>
        </li>
      </ul>
    </div>
    <!-- # endblock content (content inherited from layout.html) -->

      <!-- # endblock content (placeholder in theme.html) -->
    </div>

    <div id="footer"><hr/>
      <a id="tracpowered" href="https://trac.edgewall.org/"
         ><img src="/wiki/public/chrome/common/trac_logo_mini.png" height="30"
               width="107" alt="Trac Powered"/></a>
      <p class="left">
Powered by         <a href="/wiki/public/about"><strong>Trac 1.5.3</strong></a>
        <br />
 By         <a href="http://www.edgewall.org/">Edgewall Software</a>
.      </p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
    <!--   # include 'site_footer.html' (theme.html) -->
    <!--   end of site_footer.html -->
    <!-- # endblock body (content inherited from theme.html) -->
  </body> </html>